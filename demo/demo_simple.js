(()=>{"use strict";var t,e={322:(t,e,s)=>{var i,n,r=s(709),o=s(27);class a{constructor(t,e){const s=a.getModel(e);this.type=t,this.model=s,t===i.SELECT&&(this.isSelected=a.getSelection(s))}static getModel(t){return"model"in t?t.model:t}static getSelection(t){if("selection"in t)return t.selection;throw new Error("選択可能なボタン以外を引数にして、SELECTイベントをインスタンス化しました。SELECTイベントはISelectableObject3Dを実装したクラスとともにインスタンス化してください。")}clone(){return new a(this.type,this.model)}}!function(t){t.CLICK="THREE_MOUSE_EVENT_CLICK",t.OVER="THREE_MOUSE_EVENT_OVER",t.OUT="THREE_MOUSE_EVENT_OUT",t.DOWN="THREE_MOUSE_EVENT_DOWN",t.UP="THREE_MOUSE_EVENT_UP",t.SELECT="THREE_MOUSE_EVENT_SELECT"}(i||(i={}));class l{static getCanvasHeight(t){const e=t.style;return e.width&&e.height?parseInt(e.height):null!=window.devicePixelRatio?t.height/window.devicePixelRatio:t.height}static getCanvasWidth(t){const e=t.style;return e.width&&e.height?parseInt(e.width):null!=window.devicePixelRatio?t.width/window.devicePixelRatio:t.width}static convertToRectangle(t,e){const s=this.getCanvasHeight(t);return{x1:e.x,x2:e.x+e.width,y1:s-(e.y+e.height),y2:s-e.y}}static isContain(t,e,s){if(null==e)return!0;const i=this.convertToRectangle(t,e);return s.offsetX>=i.x1&&s.offsetX<=i.x2&&s.offsetY>=i.y1&&s.offsetY<=i.y2}static convertToMousePosition(t,e,s,i){const{x:n,y:o}=this.getMousePosition(t,e,s);return i?(i.set(n,o),i):new r.FM8(n,o)}static getMousePosition(t,e,s){return s?this.getViewportMousePosition(t,e,s):this.getCanvasMousePosition(t,e)}static getCanvasMousePosition(t,e){return{x:e.offsetX/this.getCanvasWidth(t)*2-1,y:-e.offsetY/this.getCanvasHeight(t)*2+1}}static getViewportMousePosition(t,e,s){const i=this.convertToRectangle(t,s),n=e.offsetX-i.x1,r=e.offsetY-i.y1;return{x:n/(i.x2-i.x1)*2-1,y:-r/(i.y2-i.y1)*2+1}}}class h{constructor(t,e,s,n){var a;this.raycaster=new r.iMs,this.mouse=new r.FM8,this.hasThrottled=!1,this.throttlingDelta=0,this.onTick=t=>{this.throttlingDelta+=t.delta,this.throttlingDelta<this.throttlingTime_ms||(this.hasThrottled=!1,this.throttlingDelta%=this.throttlingTime_ms)},this.onDocumentMouseMove=t=>{if(this.hasThrottled)return;this.hasThrottled=!0,t.preventDefault();const e=this.getIntersects(t);if(0===e.length)return void this.clearOver();const s=this.currentOver;this.currentOver=[];for(let t of e)if(this.checkTarget(t.object,i.OVER))break;null==s||s.forEach((t=>{this.currentOver.includes(t)||h.onButtonHandler(t,i.OUT)}))},this.onDocumentMouseUpDown=t=>{let e=i.DOWN;switch(t.type){case"mousedown":e=i.DOWN;break;case"mouseup":e=i.UP}if(!l.isContain(this.canvas,this.viewport,t)&&e===i.DOWN)return;t.preventDefault();const s=this.getIntersects(t);this.checkIntersects(s,e)},this.camera=e,this.scene=t,this.throttlingTime_ms=null!==(a=null==n?void 0:n.throttlingTime_ms)&&void 0!==a?a:33,this.viewport=null==n?void 0:n.viewport,this.canvas=s,s.addEventListener("mousemove",this.onDocumentMouseMove,!1),s.addEventListener("mousedown",this.onDocumentMouseUpDown,!1),s.addEventListener("mouseup",this.onDocumentMouseUpDown,!1),o.Fz.on(o.M9.tick,this.onTick)}clearOver(){var t;null===(t=this.currentOver)||void 0===t||t.forEach((t=>{h.onButtonHandler(t,i.OUT)})),this.currentOver=null}checkIntersects(t,e){const s=t.length;if(0!==s)for(let i=0;i<s&&!this.checkTarget(t[i].object,e);i++);}static onButtonHandler(t,e){switch(e){case i.DOWN:return void t.model.onMouseDownHandler(new a(e,t));case i.UP:return void t.model.onMouseUpHandler(new a(e,t));case i.OVER:return void(t.model.isOver||t.model.onMouseOverHandler(new a(e,t)));case i.OUT:return void(t.model.isOver&&t.model.onMouseOutHandler(new a(e,t)))}}static implementsIClickableObject3D(t){return null!==t&&"object"==typeof t&&null!==t.model&&"object"==typeof t.model&&null!==t.model.mouseEnabled&&"boolean"==typeof t.model.mouseEnabled}checkTarget(t,e,s=!1){return h.implementsIClickableObject3D(t)&&!0===t.model.mouseEnabled?(e===i.OVER&&this.currentOver.push(t),h.onButtonHandler(t,e),this.checkTarget(t.parent,e,!0)):null!=t.parent&&"Scene"!==t.parent.type?this.checkTarget(t.parent,e,s):s}getIntersects(t){return l.convertToMousePosition(this.canvas,t,this.viewport,this.mouse),this.raycaster.setFromCamera(this.mouse,this.camera),this.raycaster.intersectObjects(this.scene.children,!0)}}!function(t){t.NORMAL="normal",t.OVER="normal_over",t.DOWN="normal_down",t.DISABLE="disable"}(n||(n={}));class c{constructor(t){var e;this._isPress=!1,this._isOver=!1,this._enable=!0,this.mouseEnabled=!0,this.frozen=!1,this.state=n.NORMAL,this._alpha=1,this.view=t.view,null!==(e=this._materialSet)&&void 0!==e||(this._materialSet=t.material),this.updateMaterial()}get materialSet(){return this._materialSet}set materialSet(t){const e=t===this._materialSet;this._materialSet=t,e||this.updateMaterial()}get isOver(){return this._isOver}get isPress(){return this._isPress}onMouseDownHandler(t){this.checkActivity()&&(this._isPress=!0,this.updateState(n.DOWN),this.view.dispatchEvent(t))}onMouseUpHandler(t){if(!this.checkActivity())return;const e=this._isPress;this._isPress=!1;const s=this._isOver?n.OVER:n.NORMAL;if(this.updateState(s),this.view.dispatchEvent(t),this._isPress!=e){this.onMouseClick();let t=new a(i.CLICK,this);this.view.dispatchEvent(t)}}onMouseClick(){}onMouseOverHandler(t){this.onMouseOverOutHandler(t)}onMouseOutHandler(t){this.onMouseOverOutHandler(t)}onMouseOverOutHandler(t){this.checkActivity()&&(this._isOver=t.type===i.OVER,this.updateState(this._isOver?n.OVER:n.NORMAL),this.view.dispatchEvent(t))}set alpha(t){this._alpha=t,this.updateMaterial()}updateState(t){this.state=t,this.updateMaterial()}checkActivity(){return this._enable&&!this.frozen}enable(){this.switchEnable(!0)}disable(){this.switchEnable(!1)}updateMaterial(){var t,e;null===(t=this._materialSet)||void 0===t||t.setOpacity(this._alpha);const s=null===(e=this._materialSet)||void 0===e?void 0:e.getMaterial(this.state,this._enable);if(s)switch(this.view.type){case"Mesh":case"Sprite":this.view.material=s.material}}switchEnable(t){this._enable=t,this.state=t?n.NORMAL:n.DISABLE,this.updateMaterial()}}class d extends c{constructor(){super(...arguments),this._isSelect=!1}onMouseClick(){this._isSelect=!this._isSelect;const t=new a(i.SELECT,this);this.view.dispatchEvent(t),this.updateMaterial()}get selection(){return this._isSelect}set selection(t){this._isSelect=t,this.updateState(n.NORMAL)}updateMaterial(){this.materialSet.setOpacity(this._alpha);const t=this.materialSet.getMaterial(this.state,this._enable,this._isSelect);this.view.material=t.material}}class u extends d{constructor(){super(...arguments),this._isFrozen=!1}checkActivity(){return this._enable&&!this._isFrozen}get isFrozen(){return this._isFrozen}set isFrozen(t){this._isFrozen=t}}class v extends r.jyi{constructor(t,e){super(),this.model=new e({view:this,material:t})}}class m extends v{constructor(t){super(t,c)}}class p extends v{constructor(t){super(t,d)}}class w extends r.Kj0{constructor(t,e){super(t.geo),this.model=new e({view:this,material:t.material})}}class _ extends w{constructor(t){super(t,c)}}class E extends w{constructor(t){super(t,d)}}class O extends w{constructor(t){super(t,u)}}class g extends r.pBf{constructor(){super(),this._models=[],this.onSelectedButton=t=>{const e=t;e.isSelected&&this.select(e.model)}}addButton(...t){t.forEach((t=>{this.addModel(t.model)}))}addModel(t){this._models.push(t),t.view.addEventListener(i.SELECT,this.onSelectedButton)}removeButton(t){this.removeModel(t.model)}removeModel(t){const e=this._models.indexOf(t);return e>-1&&(this._models.splice(e,1),t.view.removeEventListener(i.SELECT,this.onSelectedButton)),t}select(t){if(-1===this._models.indexOf(t))return void console.warn("管理下でないボタンが選択処理されました。");if(t===this._selected&&t.isFrozen)return;this._selected=t;for(let e of this._models)e.selection=e.isFrozen=e===t;const e=new a(i.SELECT,t);this.dispatchEvent(e)}get selected(){return this._selected}get models(){return this._models}}class M{constructor(t){this.alpha=1,this.material=t}updateAlpha(){this._material instanceof Array?this.alphaArray=this.getAlphaArray():this.alpha=this._material.opacity}getAlphaArray(){const t=this._material,e=t.length,s=[];for(let i=0;i<e;i++)s.push(t[i].opacity);return s}set material(t){this._material=t,this.updateAlpha()}get material(){return this._material}setOpacity(t){if(this._material instanceof Array){const e=this._material.length;for(let s=0;s<e;s++)this._material[s].opacity=t*this.alphaArray[s]}else this._material.opacity=t*this.alpha}}class f{constructor(t){this.normal=new M(t.normal),this.over=f.initMaterial(t.over,this.normal),this.down=f.initMaterial(t.down,this.normal),this.disable=f.initMaterial(t.disable,this.normal),this.normalSelect=f.initMaterial(t.normalSelect,this.normal),this.overSelect=f.initMaterial(t.overSelect,this.normal),this.downSelect=f.initMaterial(t.downSelect,this.normal),this.init()}static initMaterial(t,e){return null==t?e:new M(t)}init(){if(null==this.normal)throw new Error("通常状態のマテリアルが指定されていません。");this.materials=[this.normal,this.normalSelect,this.over,this.overSelect,this.down,this.downSelect,this.disable]}getMaterial(t,e,s=!1){if(!e)return this.disable;switch(t){case n.NORMAL:return s?this.normalSelect:this.normal;case n.DOWN:return s?this.downSelect:this.down;case n.OVER:return s?this.overSelect:this.over}return this.normal}setOpacity(t){this.materials.forEach((e=>{e.setOpacity(t)}))}}let S,b,y;const T=()=>new f({normal:x(.6),over:x(.8),down:x(1),normalSelect:x(.6,16776960),overSelect:x(.8,16776960),downSelect:x(1,16776960)}),x=(t,e)=>(null==e&&(e=16777215),new r.vBJ({color:e,opacity:t,transparent:!0})),C=()=>new f({normal:R("./btn045_01.png",1),over:R("./btn045_02.png",1),down:R("./btn045_03.png",1),normalSelect:R("./btn045_01.png",.5),overSelect:R("./btn045_02.png",.5),downSelect:R("./btn045_03.png",.5)}),R=(t,e,s)=>(null==s&&(s=16777215),new r.xeV({map:(new r.dpR).load(t),color:s,opacity:e,transparent:!0})),D=(t,e)=>{t.position.set(e,20,0),t.scale.set(4,4,4),b.add(t)},P=()=>{S.render(b,y),requestAnimationFrame(P)};window.onload=()=>{b=new r.xsS,y=new r.cPb(45,1280/900,1,400),y.position.set(0,0,100),b.add(y);const t={canvas:document.getElementById("webgl-canvas"),antialias:!0};S=new r.CP7(t),S.setClearColor(new r.Ilk(0)),S.setSize(1280,900),S.setPixelRatio(window.devicePixelRatio);const e=new r.Mig(16777215,1);b.add(e),new h(b,y,S.domElement),(()=>{const t=new r.nvb(3,3,3),e=new _({geo:t,material:T()});e.position.set(-10,20,0),b.add(e)})(),(()=>{const t=new r.nvb(3,3,3),e=new E({geo:t,material:T()});e.position.set(0,20,0),b.add(e)})(),(()=>{const t=new m(C());D(t,10)})(),(()=>{const t=new p(C());D(t,20)})(),(()=>{const t=new r.nvb(3,3,3),e=(e,s)=>{const i=new O({geo:t,material:T()});return i.position.set(e,-10,0),i.model.value=s,b.add(i),i},s=new g;s.addButton(e(-10,"button01"),e(0,Math.PI),e(10,{value01:1,value02:2})),s.addButton(e(20,void 0)),s.addEventListener(i.SELECT,(t=>{console.log(t.model.value)}))})(),P()}}},s={};function i(t){var n=s[t];if(void 0!==n)return n.exports;var r=s[t]={exports:{}};return e[t](r,r.exports,i),r.exports}i.m=e,t=[],i.O=(e,s,n,r)=>{if(!s){var o=1/0;for(c=0;c<t.length;c++){for(var[s,n,r]=t[c],a=!0,l=0;l<s.length;l++)(!1&r||o>=r)&&Object.keys(i.O).every((t=>i.O[t](s[l])))?s.splice(l--,1):(a=!1,r<o&&(o=r));if(a){t.splice(c--,1);var h=n();void 0!==h&&(e=h)}}return e}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[s,n,r]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={451:0};i.O.j=e=>0===t[e];var e=(e,s)=>{var n,r,[o,a,l]=s,h=0;if(o.some((e=>0!==t[e]))){for(n in a)i.o(a,n)&&(i.m[n]=a[n]);if(l)var c=l(i)}for(e&&e(s);h<o.length;h++)r=o[h],i.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return i.O(c)},s=self.webpackChunkthreejs_interactive_object=self.webpackChunkthreejs_interactive_object||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var n=i.O(void 0,[736],(()=>i(322)));n=i.O(n)})();