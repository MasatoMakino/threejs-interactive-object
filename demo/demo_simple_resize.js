(()=>{"use strict";var e,t={184:(e,t,n)=>{var i=n(710),s=n(753),r=n(486);function a(e){return null!=e&&"interactionHandler"in e?e.interactionHandler:e}function o(e){if(null!=e&&"selection"in e)return!!e.selection;throw new Error("選択可能なボタン以外を引数にして、SELECTイベントをインスタンス化しました。SELECTイベントはISelectableObject3Dを実装したクラスとともにインスタンス化してください。")}function l(e,t,n=1){const i=a(t);return{type:e,interactionHandler:i,isSelected:(()=>{if("select"===e)return o(i)})(),pointerId:n}}const c={getInteractionHandler:a,getSelection:o,generate:l,clone:function(e){return l(e.type,e.interactionHandler,e.pointerId)}};class h extends r.A{get materialSet(){return this._materialSet}set materialSet(e){const t=e===this._materialSet;this._materialSet=e,t||this.updateMaterial()}get isOver(){return this.hoverPointerIds.size>0}isPointerOver(e){return this.hoverPointerIds.has(e)}get isPress(){return this.pressPointerIds.size>0}get enabled(){return this._enable}get mouseEnabled(){return this.interactionScannable}set mouseEnabled(e){this.interactionScannable=e}get frozen(){return this._frozen}set frozen(e){this._frozen=e,e&&(this.pressPointerIds.clear(),this.hoverPointerIds.clear())}constructor(e){super(),this.pressPointerIds=new Set,this.hoverPointerIds=new Set,this._enable=!0,this.interactionScannable=!0,this._frozen=!1,this.state="normal",this._alpha=1,this.view=e.view,this._materialSet??=e.material,this.updateMaterial()}onMouseDownHandler(e){this.checkActivity()&&(this.pressPointerIds.add(e.pointerId),this.updateState(this.calculateCurrentState()),this.emit(e.type,e))}onMouseUpHandler(e){const t=this.pressPointerIds.has(e.pointerId);if(this.pressPointerIds.delete(e.pointerId),this.checkActivity()&&(t&&this.pressPointerIds.clear(),this.updateState(this.calculateCurrentState()),this.emit(e.type,e),t)){this.onMouseClick();const t=l("click",this,e.pointerId);this.emit(t.type,t)}}onMouseClick(){}onMouseOverHandler(e){this.onMouseOverOutHandler(e)}onMouseOutHandler(e){this.onMouseOverOutHandler(e)}onMouseOverOutHandler(e){"over"===e.type?this.hoverPointerIds.add(e.pointerId):this.hoverPointerIds.delete(e.pointerId),"out"===e.type&&this.pressPointerIds.delete(e.pointerId),this.checkActivity()&&(this.updateState(this.calculateCurrentState()),this.emit(e.type,e))}set alpha(e){this._alpha=Math.max(0,e),this.updateMaterial()}updateState(e){this.state=e,this.updateMaterial()}checkActivity(){return this._enable&&!this.frozen}enable(){this.switchEnable(!0)}disable(){this.switchEnable(!1)}updateMaterial(){this._materialSet?.setOpacity(this._alpha);const e=this._materialSet?.getMaterial(this.state,this._enable);if(e)switch(this.view.type){case"Mesh":case"Sprite":this.view.material=e.material}}switchEnable(e){if(this._enable=e,!e)return this.pressPointerIds.clear(),this.hoverPointerIds.clear(),void this.updateState("disable");this.updateState(this.calculateCurrentState())}calculateCurrentState(){return this._enable?this.isPress?"down":this.isOver?"over":"normal":"disable"}}class d extends h{constructor(){super(...arguments),this._isSelect=!1}onMouseClick(){if(!this.checkActivity())return;this._isSelect=!this._isSelect;const e=l("select",this);this.emit(e.type,e),this.updateMaterial()}get selection(){return this._isSelect}set selection(e){e!==this._isSelect&&this.checkActivity()&&(this._isSelect=e,this.pressPointerIds.clear(),this.updateMaterial())}updateMaterial(){this.materialSet?.setOpacity(this._alpha);const e=this.materialSet?.getMaterial(this.state,this._enable,this._isSelect);null!=e?.material&&(this.view.material=e.material)}}class u extends d{constructor(){super(...arguments),this._isExclusivelySelected=!1}checkActivity(){return super.checkActivity()&&!this._isExclusivelySelected}get isExclusivelySelected(){return this._isExclusivelySelected}set isExclusivelySelected(e){this._isExclusivelySelected=e}get isFrozen(){return this._isExclusivelySelected}set isFrozen(e){this._isExclusivelySelected=e}_setSelectionOverride(e){if(this._isSelect=e,e)this.updateState("normal");else{const e=this.calculateCurrentState();this.updateState(e)}}}var p=n(961);class v{constructor(e,t,n,s){this.raycaster=new i.tBo,this.mouse=new i.I9Y,this.currentOver=new Map,this.hasThrottled=new Set,this.throttlingDelta=0,this._disposed=!1,this.onTick=e=>this.throttlingTime_ms<=0?(this.hasThrottled.clear(),void(this.throttlingDelta=0)):Number.isFinite(e.delta)?(this.throttlingDelta+=Math.max(e.delta,0),void(this.throttlingDelta<this.throttlingTime_ms||(this.hasThrottled.clear(),this.throttlingDelta%=this.throttlingTime_ms))):(this.hasThrottled.clear(),void(this.throttlingDelta=0)),this.onDocumentMouseMove=e=>{const t=e.pointerId;if(this.throttlingTime_ms>0){if(this.hasThrottled.has(t))return;this.hasThrottled.add(t)}e.preventDefault();const n=this.getIntersects(e);if(0===n.length)return void this.clearOver(t);const i=this.currentOver.get(t)||[];this.currentOver.set(t,[]);for(const e of n)if(this.checkTarget(e.object,"over",t))break;i.forEach((e=>{(this.currentOver.get(t)||[]).includes(e)||v.onButtonHandler(e,"out",t)}))},this.onDocumentMouseUpDown=e=>{const t=e.pointerId;let n="down";switch(e.type){case"pointerdown":n="down";break;case"pointerup":n="up"}if(!function(e,t,n){if(null==t)return!0;const i=S(e,t);return n.offsetX>=i.x1&&n.offsetX<=i.x2&&n.offsetY>=i.y1&&n.offsetY<=i.y2}(this.canvas,this.viewport,e)&&"down"===n)return;e.preventDefault();const i=this.getIntersects(e);this.checkIntersects(i,n,t)},this.onDocumentPointerCancel=e=>{e.cancelable&&e.preventDefault(),this.cleanupPointerState(e.pointerId)},this.onDocumentPointerLeave=e=>{this.cleanupPointerState(e.pointerId)},this.camera=t,this.scene=e,this.throttlingTime_ms=s?.throttlingTime_ms??33,this.viewport=s?.viewport,this.recursive=s?.recursive??!0,this.targets=s?.targets??this.scene.children,this.canvas=n,n.addEventListener("pointermove",this.onDocumentMouseMove,!1),n.addEventListener("pointerdown",this.onDocumentMouseUpDown,!1),n.addEventListener("pointerup",this.onDocumentMouseUpDown,!1),n.addEventListener("pointercancel",this.onDocumentPointerCancel,!1),n.addEventListener("pointerleave",this.onDocumentPointerLeave,!1),p.w.on("tick",this.onTick)}clearOver(e){void 0!==e?((this.currentOver.get(e)||[]).forEach((t=>{v.onButtonHandler(t,"out",e)})),this.currentOver.delete(e)):(this.currentOver.forEach(((e,t)=>{e.forEach((e=>{v.onButtonHandler(e,"out",t)}))})),this.currentOver.clear())}cleanupPointerState(e){const t=this.currentOver.get(e);t&&t.length>0&&t.forEach((t=>{v.onButtonHandler(t,"out",e)})),this.currentOver.delete(e),this.hasThrottled.delete(e)}checkIntersects(e,t,n=1){const i=e.length;if(0!==i)for(let s=0;s<i&&!this.checkTarget(e[s].object,t,n);s++);}static onButtonHandler(e,t,n=1){switch(t){case"down":return void e.interactionHandler.onMouseDownHandler(l(t,e,n));case"up":return void e.interactionHandler.onMouseUpHandler(l(t,e,n));case"over":return void(e.interactionHandler.isPointerOver(n)||e.interactionHandler.onMouseOverHandler(l(t,e,n)));case"out":return void(e.interactionHandler.isPointerOver(n)&&e.interactionHandler.onMouseOutHandler(l(t,e,n)))}}static implementsIClickableObject3D(e){return null!==e&&"object"==typeof e&&"interactionHandler"in e&&null!==e.interactionHandler&&"object"==typeof e.interactionHandler&&"interactionScannable"in e.interactionHandler&&null!==e.interactionHandler.interactionScannable&&"boolean"==typeof e.interactionHandler.interactionScannable}static implementsDepartedIClickableObject3D(e){return null!==e&&"object"==typeof e&&"model"in e&&null!==e.model&&"object"==typeof e.model}checkTarget(e,t,n=1,i=!1){if(v.implementsDepartedIClickableObject3D(e)&&console.warn("Deprecated: IClickableObject3D.model is deprecated. Please use IClickableObject3D.interactionHandler."),null!=e&&v.implementsIClickableObject3D(e)&&e.interactionHandler.interactionScannable){if("over"===t){const t=this.currentOver.get(n)||[];t.push(e),this.currentOver.set(n,t)}return v.onButtonHandler(e,t,n),this.checkTarget(e.parent,t,n,!0)}return null!=e&&null!=e.parent&&"Scene"!==e.parent.type?this.checkTarget(e.parent,t,n,i):i}getIntersects(e){!function(e,t,n,s){const{x:r,y:a}=function(e,t,n){return n?function(e,t,n){const i=S(e,n),s=t.offsetX-i.x1,r=t.offsetY-i.y1;return{x:s/(i.x2-i.x1)*2-1,y:-r/(i.y2-i.y1)*2+1}}(e,t,n):function(e,t){const n=t.offsetX/function(e){return e.clientWidth}(e)*2-1;return{x:n,y:-t.offsetY/w(e)*2+1}}(e,t)}(e,t,n);if(s)return s.set(r,a),s;new i.I9Y(r,a)}(this.canvas,e,this.viewport,this.mouse),this.raycaster.setFromCamera(this.mouse,this.camera);const t=this.raycaster.intersectObjects(this.targets,this.recursive),n=new Set;return t.filter((e=>!n.has(e.object.uuid)&&(n.add(e.object.uuid),!0)))}dispose(){this._disposed||(this._disposed=!0,this.clearOver(),this.canvas.removeEventListener("pointermove",this.onDocumentMouseMove,!1),this.canvas.removeEventListener("pointerdown",this.onDocumentMouseUpDown,!1),this.canvas.removeEventListener("pointerup",this.onDocumentMouseUpDown,!1),this.canvas.removeEventListener("pointercancel",this.onDocumentPointerCancel,!1),this.canvas.removeEventListener("pointerleave",this.onDocumentPointerLeave,!1),p.w.off("tick",this.onTick),this.hasThrottled.clear(),this.throttlingDelta=0)}}class m extends r.A{constructor(){super(...arguments),this._interactionHandlers=[],this.onSelectedButton=e=>{e.isSelected&&this.select(e.interactionHandler)}}addButton(...e){e.forEach((e=>{this.addInteractionHandler(e.interactionHandler)}))}addInteractionHandler(e){this._interactionHandlers.push(e),e.on("select",this.onSelectedButton)}removeButton(e){this.removeInteractionHandler(e.interactionHandler)}removeInteractionHandler(e){const t=this._interactionHandlers.indexOf(e);return t>-1&&(this._interactionHandlers.splice(t,1),e.off("select",this.onSelectedButton)),e}select(e){if(-1===this._interactionHandlers.indexOf(e))return void console.warn("管理下でないボタンが選択処理されました。");if(e===this._selected&&e.isExclusivelySelected)return;this._selected=e;for(const t of this._interactionHandlers)t.isExclusivelySelected=t===e,t._setSelectionOverride(t===e);const t=c.generate("select",e);this.emit(t.type,t)}get selected(){return this._selected}get interactionHandlers(){return[...this._interactionHandlers]}}class f{constructor(e){this.alpha=1,this.material=e}updateAlpha(){Array.isArray(this._material)?this.alphaArray=this.getAlphaArray():this.alpha=this._material.opacity}getAlphaArray(){const e=this._material,t=e.length,n=[];for(let i=0;i<t;i++)n.push(e[i].opacity);return n}set material(e){this._material=e,this.updateAlpha()}get material(){return this._material}setOpacity(e){if(Array.isArray(this._material)){const t=this._material.length;for(let n=0;n<t;n++)this._material[n].opacity=e*this.alphaArray[n]}else this._material.opacity=e*this.alpha}}class y{constructor(e){this.materials=[],this.normal=new f(e.normal),this.over=y.initMaterial(e.over,this.normal),this.down=y.initMaterial(e.down,this.normal),this.disable=y.initMaterial(e.disable,this.normal),this.normalSelect=y.initMaterial(e.normalSelect,this.normal),this.overSelect=y.initMaterial(e.overSelect,this.normal),this.downSelect=y.initMaterial(e.downSelect,this.normal),this.init()}static initMaterial(e,t){return null==e?t:new f(e)}init(){if(null==this.normal)throw new Error("通常状態のマテリアルが指定されていません。");this.materials=[this.normal,this.normalSelect,this.over,this.overSelect,this.down,this.downSelect,this.disable]}getMaterial(e,t,n=!1){if(!t)return this.disable;switch(e){case"normal":return n?this.normalSelect:this.normal;case"down":return n?this.downSelect:this.down;case"over":return n?this.overSelect:this.over}return this.normal}setOpacity(e){this.materials.forEach((t=>{t.setOpacity(e)}))}}function w(e){return e.clientHeight}function S(e,t){const n=w(e);return{x1:t.x,x2:t.x+t.width,y1:n-(t.y+t.height),y2:n-t.y}}i.YJl;class g extends i.eaF{constructor(e,t){super(e.geo),this.interactionHandler=new t({view:this,material:e.material})}}class b extends g{constructor(e){super(e,h)}}class _ extends g{constructor(e){super(e,d)}}class O extends g{constructor(e){super(e,u)}}class H extends i.kxk{constructor(e,t){super(),this.interactionHandler=new t({view:this,material:e})}}class I extends H{constructor(e){super(e,h)}}class x extends H{constructor(e){super(e,d)}}const M=1280;let E,k,P;const D=()=>new y({normal:C(.6),over:C(.8),down:C(1),normalSelect:C(.6,16776960),overSelect:C(.8,16776960),downSelect:C(1,16776960)}),C=(e,t)=>(null==t&&(t=16777215),new i.V9B({color:t,opacity:e,transparent:!0})),j=()=>new y({normal:T("./btn045_01.png",1),over:T("./btn045_02.png",1),down:T("./btn045_03.png",1),normalSelect:T("./btn045_01.png",.5),overSelect:T("./btn045_02.png",.5),downSelect:T("./btn045_03.png",.5)}),T=(e,t,n)=>(null==n&&(n=16777215),new i.RoJ({map:(new i.Tap).load(e),color:n,opacity:t,transparent:!0})),A=(e,t)=>{e.position.set(t,20,0),e.scale.set(4,4,4),k.add(e)},B=()=>{E.render(k,P),requestAnimationFrame(B)};window.onload=()=>{console.log(`Three.js r${i.sPf}`);const e=document.getElementById("webgl-canvas");e.parentElement.removeChild(e);const t=document.createElement("div");document.body.appendChild(t),t.appendChild(e),document.body.style.overflow="hidden",t.style.width="100vw",t.style.height="100vh",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",e.style.maxWidth="100%",e.style.maxHeight="100%",e.style.touchAction="none",Object.assign(e.style,{userSelect:"none",outline:"none"}),e.style.setProperty("-webkit-user-select","none"),e.style.setProperty("-moz-user-select","none"),e.style.setProperty("-ms-user-select","none"),e.style.setProperty("-webkit-tap-highlight-color","transparent"),e.style.setProperty("-webkit-touch-callout","none");const n=()=>{!function(e,t,n,i){const s=e.clientWidth,r=e.clientHeight,a=1280/900;s/r>a?(t.style.width=r*a+"px",t.style.height=`${r}px`):(t.style.width=`${s}px`,t.style.height=s/a+"px")}(t,e)};n(),window.addEventListener("resize",n),k=new i.Z58,P=new i.ubm(45,M/900,1,400),P.position.set(0,0,100),k.add(P);const r={canvas:document.getElementById("webgl-canvas"),antialias:!0};E=new s.JeP(r),E.setClearColor(new i.Q1f(0)),E.setSize(M,900,!1);const a=new i.$p8(16777215,1);k.add(a),new v(k,P,E.domElement),(()=>{const e=new i.iNn(3,3,3),t=new b({geo:e,material:D()});t.position.set(-10,20,0),k.add(t)})(),(()=>{const e=new i.iNn(3,3,3),t=new _({geo:e,material:D()});t.position.set(0,20,0),k.add(t)})(),(()=>{const e=new I(j());A(e,10)})(),(()=>{const e=new x(j());A(e,20)})(),(()=>{const e=new i.iNn(3,3,3),t=(t,n)=>{const i=new O({geo:e,material:D()});return i.position.set(t,-10,0),i.interactionHandler.value=n,k.add(i),i},n=new m;n.addButton(t(-10,"button01"),t(0,Math.PI),t(10,{value01:1,value02:2})),n.addButton(t(20,void 0)),n.on("select",(e=>{console.log(e.interactionHandler.value)}))})(),B()}}},n={};function i(e){var s=n[e];if(void 0!==s)return s.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,i),r.exports}i.m=t,e=[],i.O=(t,n,s,r)=>{if(!n){var a=1/0;for(h=0;h<e.length;h++){for(var[n,s,r]=e[h],o=!0,l=0;l<n.length;l++)(!1&r||a>=r)&&Object.keys(i.O).every((e=>i.O[e](n[l])))?n.splice(l--,1):(o=!1,r<a&&(a=r));if(o){e.splice(h--,1);var c=s();void 0!==c&&(t=c)}}return t}r=r||0;for(var h=e.length;h>0&&e[h-1][2]>r;h--)e[h]=e[h-1];e[h]=[n,s,r]},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={842:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var s,r,[a,o,l]=n,c=0;if(a.some((t=>0!==e[t]))){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);if(l)var h=l(i)}for(t&&t(n);c<a.length;c++)r=a[c],i.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return i.O(h)},n=self.webpackChunk_masatomakino_threejs_interactive_object=self.webpackChunk_masatomakino_threejs_interactive_object||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var s=i.O(void 0,[121],(()=>i(184)));s=i.O(s)})();